# 20250324-è¾“å‡ºæ–‡ä»¶å¤¹ç›®å½•ä¸‹çš„æ–‡ä»¶æ ‘+æ–‡ä»¶å¤§å°

> åœ¨ä¸€äº›èµ„æºç½‘ç«™ä¸Šç»å¸¸çœ‹åˆ°åˆ†äº«çš„èµ„æºç›®å½•æ ‘ï¼ŒæŠŠæ•´ä¸ªæ–‡ä»¶æ ‘éƒ½åˆ—å‡ºæ¥ï¼Œå¾ˆå¥½å¥‡æ˜¯ç”¨ä»€ä¹ˆå·¥å…·åšåˆ°çš„ã€‚

![image-20250325101756025](https://s2.loli.net/2025/03/25/6mKjhFNCQDoLT5I.png)

ç»è¿‡ä¸€ç•ªæœç´¢åŽå‘çŽ°windowsä¸Šæœ‰treeå‘½ä»¤

```
tree [è·¯å¾„]
tree /a [è·¯å¾„]
```

![image-20250325102410688](https://s2.loli.net/2025/03/25/SsvtIXFzcGoJlLq.png)

ä½†æ˜¯è¿™ä¸ªå‘½ä»¤è¾“å‡ºçš„å†…å®¹å¤ªç®€å•ï¼Œæ²¡æœ‰é™„å¸¦æ–‡ä»¶å¤§å°ä¿¡æ¯ã€‚å†³å®šè¿˜æ˜¯è‡ªå·±ç”¨ä»£ç å†™ä¸€ä¸ªã€‚

## æ ¸å¿ƒä»£ç 

ç”¨æ³•ï¼š

åœ¨ç³»ç»ŸçŽ¯å¢ƒå˜é‡ä¸­æ·»åŠ .batæ–‡ä»¶çš„è·¯å¾„ï¼ŒåŽç»­åœ¨cmdä¸­å¯ç›´æŽ¥è¾“å…¥`showtree`å³å¯ã€‚

```bash
showtree #è¾“å‡ºé»˜è®¤
showtree --emoji # è¾“å‡ºå¸¦æ–‡ä»¶ç±»åž‹å›¾æ ‡çš„åˆ—è¡¨
```

```bat
# showjree.bat
@echo off
chcp 65001 > nul
node "%~dp0showtree.js" %*
```

```js
// showtree.js
const fs = require('fs');
const path = require('path');
const util = require('util');

// è§£æžå‘½ä»¤è¡Œå‚æ•°
const args = process.argv.slice(2);
const showEmoji = args.includes('--emoji');
let currentDir = process.cwd();

// ç§»é™¤ --emoji å‚æ•°ï¼ŒèŽ·å–ç›®å½•å‚æ•°
const dirIndex = args.findIndex(arg => !arg.startsWith('--'));
if (dirIndex !== -1) {
  currentDir = args[dirIndex];
}

// æ–‡ä»¶ç±»åž‹å¯¹åº”çš„ emoji
const fileEmojis = {
  // å›¾ç‰‡æ–‡ä»¶
  '.jpg': 'ðŸ–¼ï¸', '.jpeg': 'ðŸ–¼ï¸', '.png': 'ðŸ–¼ï¸', '.gif': 'ðŸ–¼ï¸', 
  '.bmp': 'ðŸ–¼ï¸', '.svg': 'ðŸ–¼ï¸', '.webp': 'ðŸ–¼ï¸',
  
  // æ–‡æ¡£æ–‡ä»¶
  '.doc': 'ðŸ“', '.docx': 'ðŸ“', '.rtf': 'ðŸ“', '.txt': 'ðŸ“', '.md': 'ðŸ“',
  
  // è¡¨æ ¼æ–‡ä»¶
  '.xls': 'ðŸ“Š', '.xlsx': 'ðŸ“Š', '.csv': 'ðŸ“Š',
  
  // æ¼”ç¤ºæ–‡ä»¶
  '.ppt': 'ðŸ“½ï¸', '.pptx': 'ðŸ“½ï¸',
  
  // PDFæ–‡ä»¶
  '.pdf': 'ðŸ“‘',
  
  // éŸ³é¢‘æ–‡ä»¶
  '.mp3': 'ðŸŽµ', '.wav': 'ðŸŽµ', '.flac': 'ðŸŽµ', '.ogg': 'ðŸŽµ', '.m4a': 'ðŸŽµ',
  
  // è§†é¢‘æ–‡ä»¶
  '.mp4': 'ðŸŽ¬', '.avi': 'ðŸŽ¬', '.mov': 'ðŸŽ¬', '.wmv': 'ðŸŽ¬', 
  '.mkv': 'ðŸŽ¬', '.webm': 'ðŸŽ¬',
  
  // åŽ‹ç¼©æ–‡ä»¶
  '.zip': 'ðŸ—œï¸', '.rar': 'ðŸ—œï¸', '.7z': 'ðŸ—œï¸', '.tar': 'ðŸ—œï¸', '.gz': 'ðŸ—œï¸',
  
  // å¯æ‰§è¡Œæ–‡ä»¶
  '.exe': 'âš™ï¸', '.msi': 'âš™ï¸', '.bat': 'âš™ï¸', '.cmd': 'âš™ï¸',
  
  // ç½‘é¡µæ–‡ä»¶
  '.html': 'ðŸŒ', '.htm': 'ðŸŒ', '.xml': 'ðŸŒ',
  
  // JavaScript/TypeScriptæ–‡ä»¶
  '.js': 'ðŸ“œ', '.ts': 'ðŸ“œ',
  
  // React/Vueç»„ä»¶
  '.jsx': 'âš›ï¸', '.tsx': 'âš›ï¸', '.vue': 'âš›ï¸', '.svelte': 'âš›ï¸',
  
  // æ ·å¼æ–‡ä»¶
  '.css': 'ðŸŽ¨', '.less': 'ðŸŽ¨', '.scss': 'ðŸŽ¨', '.sass': 'ðŸŽ¨',
  
  // é…ç½®æ–‡ä»¶
  '.json': 'ðŸ”§', '.yaml': 'ðŸ”§', '.yml': 'ðŸ”§',
  
  // ç³»ç»Ÿæ–‡ä»¶
  '.dll': 'âš™ï¸', '.sys': 'âš™ï¸', '.ini': 'âš™ï¸',
};

// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
function formatFileSize(bytes) {
  if (bytes >= 1073741824) {
    return (bytes / 1073741824).toFixed(2) + ' GB';
  } else if (bytes >= 1048576) {
    return (bytes / 1048576).toFixed(2) + ' MB';
  } else if (bytes >= 1024) {
    return (bytes / 1024).toFixed(2) + ' KB';
  } else {
    return bytes + ' B';
  }
}

// é€’å½’éåŽ†ç›®å½•æ ‘
function showDirectoryTree(dirPath, prefix = '') {
  const items = fs.readdirSync(dirPath);
  
  items.forEach((item, index) => {
    const itemPath = path.join(dirPath, item);
    const stats = fs.statSync(itemPath);
    const isLast = index === items.length - 1;
    
    // ç¡®å®šå‰ç¼€å’Œè¿žæŽ¥ç¬¦
    const connector = isLast ? 'â””â”€â”€ ' : 'â”œâ”€â”€ ';
    const newPrefix = prefix + (isLast ? '    ' : 'â”‚   ');
    
    if (stats.isDirectory()) {
      // ç›®å½•
      const dirEmoji = showEmoji ? 'ðŸ“ ' : '';
      console.log(`${prefix}${connector}${dirEmoji}${item}`);
      showDirectoryTree(itemPath, newPrefix);
    } else {
      // æ–‡ä»¶
      const extension = path.extname(item).toLowerCase();
      const emoji = showEmoji ? (fileEmojis[extension] || 'ðŸ“„') + ' ' : '';
      const size = formatFileSize(stats.size);
      console.log(`${prefix}${connector}${emoji}${item} [${size}]`);
    }
  });
}

// æ˜¾ç¤ºç›®å½•æ ‘æ ‡é¢˜
console.log('\nðŸ“‚ ç›®å½•æ ‘ (åŒ…å«æ–‡ä»¶å¤§å°):\n');
console.log(currentDir);
console.log('â”€'.repeat(Math.min(80, currentDir.length)));
showDirectoryTree(currentDir);
console.log('\nå®Œæˆï¼æŒ‰ä»»æ„é”®é€€å‡º...');

// ç­‰å¾…ç”¨æˆ·æŒ‰é”®é€€å‡º
if (process.stdin.isTTY) {
  process.stdin.setRawMode(true);
}
process.stdin.resume();
process.stdin.on('data', () => process.exit(0));
```

æ•ˆæžœï¼š

![image-20250325110534787](https://s2.loli.net/2025/03/25/wG6tNASFnQxy4Eb.png)

![image-20250325110550134](https://s2.loli.net/2025/03/25/tSTmcJ26udZjolv.png)
