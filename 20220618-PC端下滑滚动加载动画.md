# 20220618-PCç«¯ä¸‹æ»‘æ»šåŠ¨åŠ è½½åŠ¨ç”»

## å®ç°åŸç†

### 1. å®ç°ä¸‹æ»‘æ»šåŠ¨åˆ°å†…å®¹åŒºåŸŸï¼Œå†…å®¹å†æ˜¾ç¤º

 - 	ä¸€å¼€å§‹æ¯ä¸ªåŒºåŸŸçš„divè®¾ç½®`opacity`ä¸º0ï¼Œç­‰æ»‘åŠ¨åˆ°è‡ªèº«æ‰€åœ¨ä½ç½®æ—¶ï¼Œå†è®¾ç½®å›`opacity:1`ï¼ŒåŒæ—¶è®¾ç½®åŠ¨ç”»ã€‚

â€‹	æ ¸å¿ƒä»£ç :

â€‹	çˆ¶ç»„ä»¶æ–¹æ³•ï¼š
â€‹	`scrollTop`ï¼š`document.documentElement.scrollTop`æ˜¯ä½ ä¸‹æ‹‰æ»šåŠ¨äº†å¤šå°‘åƒç´ 

â€‹	`scrllHeight`: `window.innerHeight`æµè§ˆå™¨çª—å£çš„è§†å£çš„é«˜åº¦
â€‹	![innerHeight vs outerHeight illustration](https://s2.loli.net/2022/06/18/c3fxlLTEoWK4IPb.png)

â€‹	`elTop`: `that.$refs[el].offsetTop`è·å–è¯¥å…ƒç´ è·ç¦»bodyé¡¶éƒ¨çš„åƒç´ 
â€‹	![img](https://s2.loli.net/2022/06/18/3oGbv5Ijx6dmCrR.jpg)

```html
<div
      ref="academybox"
      class="home-block flex-ccc block2"
      :class="{opacity: !academyTitAnimation}"
    >
      <div class="home-list type2">
        <AcademyList
          ref="academy"
          :animation="academyAnimation"
          :scrollToTop="scrollToTop"
          :list="school_campus.list"
        />
      </div>
    </div>
```



```js
scrollToTop (that, el, key) {
    //el æ˜¯æ¯ä¸ªç»„ä»¶çš„refåå­—
    //key æ˜¯æ¯ä¸ªæ§åˆ¶æ¯ä¸ªç»„ä»¶çš„opacityå’ŒåŠ¨ç”»çš„å˜é‡åç§°
    var scrollTop = document.documentElement.scrollTop
    var scrllHeight = window.innerHeight
    const elTop = that.$refs[el] && that.$refs[el].offsetTop
    if ((scrollTop + scrllHeight - 80) >= elTop) {
        this[key] = true //æ˜¾ç¤ºdomåŒæ—¶æ˜¾ç¤ºåŠ¨ç”»
    }
},
```



æ¯ä¸ªç»„ä»¶å†…ä½¿ç”¨`isanimation`æ§åˆ¶åŠ¨ç”»è§¦å‘

```html
<div class="flex-c academy" ref="academy">
    <div class="academy-item" @click="goNav(item)" :style="[cutomStyle]" v-for="(item, index) in list" :key="index" :class="{animation: animation && isanimation}">
      <img :src="item.cover_url" />
      <div class="academy-main">
        <div class="academy-title">{{ item.title }}</div>
        <div class="academy-content">{{ item.about }}</div>
      </div>
    </div>
  </div>
```

â€‹	æ¯ä¸ªç»„ä»¶å†…éƒ¨ç›‘å¬`scroll`äº‹ä»¶ï¼Œ

```js
props: {
    scrollToTop: {
        type: Function,
        default: () => {}
    },
}, 
mounted () {
      window.addEventListener('scroll', () => { this.scrollToTop(this, 'academy', 'academyAnimation') }, true)
    }
```

### åŠ¨ç”»ä»£ç 

```css
//App.vue
.animation {
  &:nth-child(n) {
    animation: movefromLeft2 2.5s;
    animation-fill-mode: forwards;
  }
  &:nth-child(2n) {
    animation: movefromLeft2 2s;
    animation-fill-mode: forwards;
  }
  &:nth-child(3n) {
    animation: movefromRight2 2s;
    animation-fill-mode: forwards;
  }
  &:nth-child(4n) {
    animation: movefromRight2 2.5s;
    animation-fill-mode: forwards;
  }
}
@keyframes movefromRight2 {
  from {
    opacity: 0;
    transform: translateX(200%);
  }
  to {
    opacity: 1;
    transform: translateX(0px);
  }
}
@keyframes movefromLeft2 {
  from {
    opacity: 0;
    transform: translateX(-200%);
  }
  to {
    opacity: 1;
    transform: translateX(0px);
  }
}
```

æ•ˆæœ

![pc](https://s2.loli.net/2022/06/18/jaurVfmNthP9DGd.gif)



## ç‚¹å‡»é”šç‚¹æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®

### æ•ˆæœ

![pc-2](https://s2.loli.net/2022/06/18/bizgESPte97BCfD.gif)



### å®ç°åŸç†

ç‚¹å‡»æ¯ä¸ªå¯¼èˆªdivæ—¶ï¼Œè·å–è¯¥divçš„æ‰€åœ¨ä½ç½®(`offsetLeft`)ï¼Œè¿˜æœ‰è¯¥divçš„å®½åº¦ï¼ŒæŠŠå°çº¢æ¡ç”¨ç»å¯¹å®šä½åŠ ä¸Š`transition`è¿›è¡Œç§»åŠ¨ã€‚

- è·å–divæ‰€åœ¨ä½ç½®: `Element.offsetLeft`å¯ä»¥è·å–è¯¥divç›¸å¯¹äºçˆ¶å…ƒç´ çš„è·ç¦»
- è·å–divçš„å®½åº¦: `Element.scrollWidth`ã€`Element.clientWidth`ã€`Element.getBoundingClientRect().width`ï¼Œéƒ½å¯ä»¥



### æ ¸å¿ƒä»£ç 

å¯¼èˆªåˆ—è¡¨æ•°æ®ç»“æ„ï¼š

```js
[
    {
        name: 'é¦–é¡µ',
        highlight:0,
        url:''
    },
    {
        name: 'çº¿ä¸Šè¯¾ç¨‹',
        highlight:1,
        url:''
    },
]
```

ä½¿ç”¨å”¯ä¸€çš„`highlight`è®¾ç½®`ref` ï¼Œæ–¹ä¾¿è·å–dom

```html
<div class="flex-c navs">
            <div class="nav" v-for="(item, index) in navs" :ref="'nav' + highlight" :key="index" :class="{active: highlight === index}" @click="goNav(item, index)">
              {{ item.name }}
              <div v-if="item.children && item.children.length" class="children brrs">
                <div v-for="(i, k) in item.children" :key="k" class="children-item" @click="goNav(i)">
                  {{ i.name }}
                </div>
              </div>
            </div>
            <div class="line" :style="[lineStyle]"></div>
          </div>
```



```js
 goNav (item) {
     if(item.highlight>-1) { //è®¾ç½®æ»‘å—ä½ç½®
         this.SaveHighlight(item.highlight)
     }

     if (item.url && item.url !== this.$route.name) {//å¦‚æœæ˜¯è·¯ç”±åˆ™è·³è½¬
         this.$nav(item.url, item.query || {})
     } else if (item.fun) { //è‡ªå®šä¹‰æ–¹æ³•
         this[item.fun]()
     }
 },
setLine () {
    if (this.highlight > -1) {
        if(!this.$refs['nav' + this.highlight]) {
            return
        }
        let porp = this.$refs['nav' + this.highlight][0]
        this.lineStyle = {
            width: porp && porp['scrollWidth'] + 'px',
            left: porp && porp['offsetLeft'] + 'px'
        }
    } else {
        this.lineStyle = {
            width: 0,
            left: 0
        }
    }
},
```



## è½®æ’­å›¾æ’ä»¶ä½¿ç”¨

### vue-awesome-swiper åŸºäºSwiperäºŒæ¬¡å°è£…çš„Vueç»„ä»¶

> [GitHub - surmon-china/vue-awesome-swiper: ğŸ† Swiper component for @vuejs](https://github.com/surmon-china/vue-awesome-swiper)
>
> [vue-awesome-swiper | Homepage (surmon.me)](https://github.surmon.me/vue-awesome-swiper)

ç°åœ¨å·²ç»åœæ­¢ç»´æŠ¤ï¼Œå› ä¸ºSwiperå·²ç»æ¨å‡ºäº†æ”¯æŒTSçš„Vueç‰ˆæœ¬



### Swiper å®˜æ–¹æ’ä»¶

> [Swiper Vue.js Components (swiperjs.com)](https://swiperjs.com/vue)

è¿™æ˜¯ä¸“é—¨ç”¨äºVue3 + TSçš„ç»„ä»¶



#### åˆå§‹åŒ–è½®æ’­å›¾

```html
<div class="home-container">
      <div class="swiper-wrapper">
        <div class="swiper-slide" v-for="(item, index) in banner" :key="index">
          <img :src="item.cover_url" @click="clickBanner(item)" />
        </div>
      </div>
      <div class="swiper-pagination"></div>
    </div>
```



```js
//é¡µé¢å¼•å…¥
import Swiper from 'swiper'
import 'swiper/dist/css/swiper.css'

//åˆå§‹åŒ–ï¼Œä¼ å…¥é…ç½®
this.homeSwiper = new Swiper('.home-container', this.swiperOptions)

//é…ç½®
swiperOptions: {
          loop: true,
          speed: 2000,
          pagination: '.swiper-pagination',
          paginationClickable: true,
          // å¦‚æœéœ€è¦è‡ªåŠ¨åˆ‡æ¢æµ·æŠ¥
          autoplay: 5000,
          // effect: 'silde'
          effect: IEVersion() === -1 ? 'cube' : 'silde' //cubeæ˜¯3Dæ•ˆæœ
        }
```















